var site=getDomain(window.location.hostname);var config={apiKey:"AAAAt9MkZ_o:APA91bGaXrOdFcmMZNmHBvMPXsGJNpt_HsBlDnubgbKLmyDqQszeUv3lgCzbjySnj5ZbASIXBa7y8ziX9vQNOpgxezT2COCfT4uJ3Dn_ehf5eUlOrH3xadYrL4nn2Q-DFopSDdDD-HfNj-7ybS6l8qaiU3WK14i1xQ",messagingSenderId:"789521393658",};firebase.initializeApp(config);const messaging=firebase.messaging();messaging.usePublicVapidKey("BJ3tbRbZ9QGajqvrMTLPpMWie0CIWnk1odpXw2X7LM6f1H4O9cfJjTkFVjjI2ZoOu3jyQtf0ackGQlLVCE00lh8");var notifkgmediaorigin_cookie=getCookie('notifkgmediaorigin');var id="null";if(notifkgmediaorigin_cookie!="true")
{messaging.requestPermission().then(function(){messaging.getToken().then(function(currentToken){req=new XMLHttpRequest();req.open("POST","https://asgard.kompas.com/kgmedia_subscribe",!0);req.send(JSON.stringify({"token":currentToken,"site":site,"kompasid":id}));setCookie('notifkgmediaorigin','true',365)}).catch(function(err){console.log('An error occurred while retrieving token. ',err)})}).catch(function(err){console.log('Unable to get permission to notify.',err)})}
messaging.onMessage(function(payload){navigator.serviceWorker.register('firebase-messaging-sw.js');navigator.serviceWorker.ready.then(function(registration){var notificationOptions={body:payload.notification.body,icon:payload.notification.icon,data:{url:payload.notification.click_action},};registration.showNotification(payload.notification.title,notificationOptions)})});function setCookie(cname,cvalue,exdays){var d=new Date();d.setTime(d.getTime()+(exdays*24*60*60*1000));var expires="expires="+d.toUTCString();document.cookie=cname+"="+cvalue+";"+expires+";domain=."+site+";path=/"}
function getCookie(cname){var name=cname+"=";var ca=document.cookie.split(';');for(var i=0;i<ca.length;i++){var c=ca[i];while(c.charAt(0)==' '){c=c.substring(1)}
if(c.indexOf(name)==0){return c.substring(name.length,c.length)}}
return null}
function getHostName(url){var match=url.match(/:\/\/(www[0-9]?\.)?(.[^/:]+)/i);if(match!=null&&match.length>2&&typeof match[2]==='string'&&match[2].length>0){return match[2]}
else{return url}}
function getDomain(url){var hostName=getHostName(url);var domain=hostName;if(hostName!=null){var parts=hostName.split('.').reverse();if(parts!=null&&parts.length>1){domain=parts[1]+'.'+parts[0];if(hostName.toLowerCase().indexOf('.co.uk')!=-1&&parts.length>2){domain=parts[2]+'.'+domain}}}
return domain}