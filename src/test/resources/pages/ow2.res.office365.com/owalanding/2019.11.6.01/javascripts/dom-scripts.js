jQuery(document).ready(function(e){function t(e){for(var t=/\s+/,a=Math.floor(e.length/2),n=0;n<a;n++){var i=a-n,o=a+n;if(-1!==e[i].search(t))return i;if(-1!==e[o].search(t))return o}return e.length}function a(t){e(".masthead").on("onscreen",function(a,n){n.percentInviewVertical<t?e(".sticky-header").addClass("visible"):e(".sticky-header").removeClass("visible")})}function n(t,a,n){e(t).on("onscreen",function(t,i){i.percentInview>a?e(n||this).addClass("ready-to-animate"):e(n||this).removeClass("ready-to-animate")})}function i(){var e=new Date,t=new Date(e.getFullYear()+1,e.getMonth(),e.getDate());document.cookie=p+"; expires="+t.toUTCString()}function o(){-1!==document.cookie.indexOf(u)&&(document.cookie=u+"= ; expires="+new Date(0).toUTCString(),i())}function s(){return-1===document.cookie.indexOf(p)&&-1===document.cookie.indexOf(u)}function r(){e("#mobile-speedbump").addClass("launched"),e("#mobile-speedbump").attr("aria-hidden","false"),e.each(b,function(t,a){e(a).attr("tabindex","-1")}),e("#mobile-speedbump [tabindex]").attr("tabindex","0"),e("#mobile-speedbump .secondary a").focus(),e("body").addClass("locked"),e(f).ontouchend=function(e){e.preventDefault()}}function l(){e("[tabindex]").attr("tabindex","0"),e("#mobile-speedbump [tabindex]").attr("tabindex","-1"),e("#mobile-speedbump").removeClass("launched"),e("#mobile-speedbump").attr("aria-hidden","true"),e("body").removeClass("locked")}e("body").removeClass("preload"),vhCheck(),e("a:not(.internal)").each(function(){e(this).attr("target","_blank")});var c=getOS();e("body").attr("data-likely-os",getOS()),"iOS"==c||"Android"==c?e("body").attr("data-is-probably-mobile-os","true"):e("body").attr("data-is-probably-mobile-os","false"),e(".user-agent-test li i").html(c);var d=window.location.search;0===d.length?d="?nlp=1":-1===d.indexOf("nlp=1")&&(d+="&nlp=1"),e(".sign-in-link").attr("href","./"+d),e(".premium-appeal p a").each(function(t,a){e(a).html(e(a).html().replace(/([^\s]+)$/,function(e,t){return'<i class="final-phrase">'+t+"</i>"}))}),e(".halve-me").each(function(a,n){var i=e(n).html(),o=t(i),s=i.slice(0,o).trim(),r=i.slice(o,i.length).trim();e(n).html(s+"</span><span>"+r)});var m;e("[name='a-simple-experience']").find(".buttons-captions").attr("data-current","1"),e("[name='a-simple-experience']").find(".buttons-track li:nth-of-type(1)").addClass("current"),e("[name='a-simple-experience'] .buttons-track li").on("focus mouseover",function(){m=e(this).index(),m+=1,e("[name='a-simple-experience'] .buttons-track li").attr("class",""),e(this).addClass("current"),e("[name='a-simple-experience'] .buttons-captions").attr("data-current",m),e(".monitor .scenario").removeClass("active"),e(".monitor .scenario[data-scenario='"+m+"']").addClass("active")}),a("iOS"==c|"Android"==c?55:90),e('[name="productivity-apps"] header span').on("onscreen",function(t,a){a.percentInview>90?e(this).addClass("visible"):e(this).removeClass("visible")}),n(".masthead",0,".masthead .primary-content"),n(".productivity-row",1),n(".premium-appeal .plate",1,".premium-appeal .plate"),n('[name="accessibility-addendum"]',1),n('[name="productivity-apps"] .visualization',1),n(".links-graveyard .bound",1,".links-graveyard"),n(".welcome-to-outlook .text",1,".welcome-to-outlook"),n(".welcome-to-outlook .icons-row",1,".welcome-to-outlook .icons-row"),n('[name="security"]',1),n(".features .icon",99),n('[name="time-management"] .family-photograph',1),n('[name="time-management"] .scenario',1),n('[name="a-simple-experience"] header',1),n(".hotmail-explanation",1);var u=(new LazyLoad({elements_selector:".lazy",threshold:800}),"X-OPS"),p="speedbumpShown=speedbump",b=e("a[href], area[href], input:not([disabled]), select:not([disabled]), textarea:not([disabled]), button:not([disabled]), iframe, object, embed, *[tabindex], *[contenteditable]"),f=e("#mobile-speedbump")[0],h=e("#mobile-speedbump .secondary a")[0],v=e(".mobile-speedbump-close")[0],c=getOS();if("iOS"===c||"Android"===c){var y=s();o(),e("[data-task='signin']").click(function(){y&&(event.preventDefault(),i(),r(),y=!1)})}e(f).on("keydown",function(e){"Tab"===e.key?e.shiftKey&&document.activeElement===v?(e.preventDefault(),h.focus()):e.shiftKey||document.activeElement!==h||(e.preventDefault(),v.focus()):"Escape"==e.key&&l()}),e("#mobile-speedbump .mobile-speedbump-close").click(function(){l()})});